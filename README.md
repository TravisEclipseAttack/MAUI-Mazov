## 1. Введение

В рамках данного проекта был разработан клиент-серверный мессенджер, реализующий обмен сообщениями в режиме реального времени. Проект состоит из двух основных частей:

* **Сервер** — ASP.NET Core Web API с использованием SignalR
* **Клиент** — кроссплатформенное приложение на .NET MAUI

Цель проекта — создать основу мессенджера с архитектурой, близкой к промышленным решениям (Telegram, WhatsApp), с поддержкой:

* регистрации и логина пользователей;
* подключения в реальном времени;
* личных (1-на-1) чатов;
* расширяемости под будущие функции.

---

## 2. Архитектура проекта

### 2.1 Общая схема

```
+-------------------+        SignalR        +----------------------+
|                   |  <---------------->  |                      |
|  MAUI Client      |                      |  ASP.NET Core Server |
|  (Windows)        |                      |  + SignalR Hub       |
|                   |                      |                      |
+-------------------+                      +----------------------+
```

* Клиент подключается к серверу по HTTP/WebSocket
* SignalR обеспечивает двусторонний обмен сообщениями
* Идентификация пользователя происходит по логину

---

## 3. Серверная часть (MessengerServer)

### 3.1 Используемые технологии

* .NET 8
* ASP.NET Core
* SignalR
* C#

### 3.2 Назначение сервера

Сервер выполняет следующие функции:

* принимает подключения клиентов;
* сопоставляет соединения с логинами пользователей;
* передаёт приватные сообщения между конкретными пользователями;
* выступает центральной точкой коммуникации.

---

### 3.3 SignalR Hub

Основным элементом сервера является `ChatHub`.

Функции хаба:

* приём приватных сообщений;
* доставка сообщений конкретному пользователю;
* работа с `UserIdentifier`.

Логика отправки сообщений:

```
User A -> Server (SendPrivate)
Server -> User B (ReceivePrivate)
```

### 3.4 Идентификация пользователей

Для корректной работы приватных сообщений используется `IUserIdProvider`.

Пользователь идентифицируется по логину, переданному в QueryString:

```
/chat?login=user1
```

Это позволяет SignalR использовать метод:

```
Clients.User(login)
```

---

### 3.5 Публикация сервера в exe

Сервер публикуется в виде self-contained `.exe` файла:

* не требует установленного .NET;
* запускается без Visual Studio;
* может работать на любом Windows ПК.

---

## 4. Клиентская часть (MauiMessenger)

### 4.1 Используемые технологии

* .NET MAUI
* C#
* XAML
* SignalR Client

### 4.2 Архитектура клиента

Клиент состоит из нескольких экранов:

1. **UsersPage** — список пользователей
2. **ChatPage** — экран чата с выбранным пользователем
3. **AppShell** — навигация

Используется Shell-навигация, соответствующая рекомендациям Microsoft.

---

## 5. Экран списка пользователей (UsersPage)

### 5.1 Назначение

UsersPage отображает список доступных пользователей и позволяет выбрать, с кем начать диалог.

### 5.2 Логика работы

```
Открытие приложения
        ↓
Загрузка списка пользователей
        ↓
Выбор пользователя
        ↓
Переход в ChatPage
```

Навигация осуществляется через:

```
Shell.Current.GoToAsync("chat?user=login")
```

---

## 6. Экран чата (ChatPage)

### 6.1 Назначение

ChatPage предназначен для общения между двумя пользователями в режиме реального времени.

### 6.2 Основные возможности

* отображение истории сообщений;
* отправка сообщений;
* получение сообщений;
* автоматическая прокрутка вниз;
* визуальное разделение сообщений (лево / право).

---

### 6.3 Визуальная схема сообщений

```
User A:                   User B:

[Привет] -------------->
             <----------- [Привет!]
[Как дела?] ----------->
             <----------- [Отлично]
```

* сообщения текущего пользователя отображаются справа;
* сообщения собеседника — слева.

---

### 6.4 Прокрутка сообщений

При добавлении нового сообщения выполняется автоматическая прокрутка:

```
MessagesCollectionView.ScrollTo(Messages.Count - 1)
```

Это гарантирует, что последнее сообщение всегда видно пользователю.

---

## 7. Работа с SignalR на клиенте

### 7.1 Подключение

При открытии ChatPage:

* создаётся `HubConnection`;
* выполняется подключение к серверу;
* логин пользователя передаётся в QueryString.

### 7.2 Приём сообщений

Клиент подписывается на событие:

```
ReceivePrivate
```

При получении сообщения:

* оно добавляется в коллекцию `Messages`;
* интерфейс автоматически обновляется;
* выполняется прокрутка вниз.

---

## 8. Публикация клиента в exe

Клиентское приложение публикуется как Windows-приложение:

* Target framework: `net8.0-windows10.0.19041.0`
* Deployment mode: `Self-contained`
* Runtime: `win-x64`

Результат:

* `.exe` файл;
* запуск без Visual Studio;
* возможность распространения.

---

## 9. Тестирование

В процессе тестирования были проверены:

* подключение нескольких пользователей;
* отправка сообщений между `user1` и `string`;
* корректность навигации;
* устойчивость соединения;
* корректная прокрутка сообщений.

Все основные сценарии работают корректно.

---

## 10. Возможности для развития

Проект имеет хорошую базу для дальнейшего расширения:

* список диалогов (ChatsPage);
* хранение истории сообщений в БД;
* индикаторы онлайн/оффлайн;
* уведомления;
* авторизация по токену;
* мобильные версии (Android, iOS).

---

## 11. Заключение

В ходе работы был успешно разработан клиент-серверный мессенджер с использованием современных технологий .NET. Архитектура проекта соответствует реальным промышленным подходам и позволяет легко масштабировать функциональность.

Проект демонстрирует:

* понимание клиент-серверного взаимодействия;
* работу с real-time технологиями;
* умение проектировать UI и навигацию;
* практические навыки C# и .NET.

---

**Проект готов к демонстрации и дальнейшему развитию.**
